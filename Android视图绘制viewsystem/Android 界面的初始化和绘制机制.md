# Android 界面的初始化和绘制机制

### 1.activity作为程序入口，会在创建activity之后执行以下步骤

在 Android 中，当一个 `Activity` 被创建后，会经历一系列生命周期回调方法，其中包括以下主要操作：

1. **onCreate()**：这是 `Activity` 的第一个生命周期回调方法。在此方法中，您可以进行初始化操作，例如设置布局、绑定视图组件、获取 Intent 数据等。但请注意，此时尚未开始绘制视图，只是进行初始化工作。
2. **onStart()**：在 `onStart()` 方法中，`Activity` 进入可见状态，但仍然没有获得用户焦点。在此阶段，您可以执行一些初始化或准备工作。
3. **onResume()**：`onResume()` 是 `Activity` 进入活动状态的阶段。此时，`Activity` 可见且获得用户焦点。通常，您会在此方法中执行启动动画、开始定时器、注册广播接收器等操作。
4. **onPause()**：当用户导航到另一个 `Activity`、按下 Home 键或触发其他情况时，`Activity` 将进入暂停状态。在 `onPause()` 中，您通常会执行停止动画、释放资源、取消网络请求等操作。
5. **onStop()**：`onStop()` 是 `Activity` 进入停止状态的阶段。在此方法中，`Activity` 不再可见，但仍然存在于内存中。您可以在此处执行一些资源释放、停止服务、取消监听器等操作。

这些生命周期回调方法会在 `Activity` 创建后依次执行。在 `onResume()` 之前，视图系统（View System）还未开始绘制视图。`onResume()` 是 `Activity` 进入活动状态，视图系统开始绘制用户界面的时刻。

需要注意的是，视图的绘制操作通常是在 `onResume()` 之后执行的，而不是在 `Activity` 的 `onCreate()`、`onStart()` 或 `onPause()` 中。因此，如果您需要执行与视图绘制相关的操作，通常应该在 `onResume()` 方法中完成。

### 2.viewsystem 的工作

这些操作是由 Android 系统的视图绘制引擎（View System）来执行的，而不是由视图组件自身来执行。Android 的视图绘制流程是由系统自动管理和执行的。

具体来说，以下是 Android 系统视图绘制引擎（View System）的工作流程：

1. **创建视图层次结构**：系统会根据您的布局文件或代码中的视图定义，创建一个视图组件的层次结构。
2. **测量（Measure）**：系统会在 `onMeasure()` 阶段测量每个视图组件的大小，确保它们适应屏幕并满足布局的要求。
3. **布局（Layout）**：在 `onLayout()` 阶段，系统会根据测量结果，确定每个视图组件的位置和边界。
4. **绘制（Draw）**：最后，在 `onDraw()` 阶段，系统会执行实际的绘制操作，将每个视图组件的内容绘制到屏幕上。

这个绘制流程是由 Android 系统的视图绘制引擎自动触发和执行的，它负责整个视图组件的绘制过程，包括视图的测量、布局和绘制。视图组件自身的 `onMeasure()`、`onLayout()` 和 `onDraw()` 方法会被系统调用，但实际的绘制工作是由系统来完成的。

视图组件的 `onDraw()` 方法是用于自定义绘制内容的地方，您可以在这个方法中编写自定义的绘制代码，例如绘制背景、文本、图形等。但整个绘制过程，包括视图的测量和布局，是由系统管理和执行的。

### 3.view system异步绘制性

实际上，Android 的视图系统（View System）的工作不会等待 `Activity` 的生命周期方法执行完毕。视图系统是独立于 `Activity` 生命周期的一部分，它负责视图的创建、测量、布局和绘制，同时协调管理多个 `Activity` 的视图。

当一个 `Activity` 被创建并进入活动状态时，视图系统会根据布局定义和视图组件的状态，开始执行视图的测量、布局和绘制工作。这个工作是异步进行的，并不会等待 `Activity` 的生命周期方法执行完毕。

例如，在 `Activity` 的 `onCreate()` 方法中，您可以设置布局和视图组件，但视图的实际绘制工作是在稍后的时间点进行的。当 `Activity` 进入活动状态并准备好显示用户界面时，视图系统会自动触发测量、布局和绘制操作，以呈现界面。

这意味着视图系统和 `Activity` 的生命周期是并行执行的，系统会尽力确保视图的正确绘制，即使 `Activity` 的生命周期方法尚未完全执行也会进行绘制工作。这种异步执行的方式有助于提高应用程序的性能和响应性。

#### 4.view system绘制时机每一个frame绘制一次

调用view.invalidate刷新立即重绘

### 5.过程解析

activity->setcontentview()->viewsystem进行解析xml/创建视图/绘制视图
是的，一旦 `onCreate()` 方法执行完毕，Android 的视图系统（View System）会根据布局文件（或通过代码创建的视图层次结构）来创建和绘制视图组件。这个过程通常在 `onResume()` 方法之后开始。

具体的流程如下：

1. **布局加载**：在 `onCreate()` 方法中，您通常会通过调用 `setContentView()` 方法来指定一个布局资源文件，该资源文件定义了应该如何排列和组合视图组件。Android 的视图系统会解析这个布局资源文件，并为每个视图组件创建相应的 `View` 对象。
2. **测量（Measure）**：一旦视图组件被创建，视图系统会在后续的绘制流程中执行测量操作，以确定每个视图组件的大小和位置。这个操作是为了确保视图组件适应屏幕，并满足布局的要求。
3. **布局（Layout）**：在测量完成后，视图系统会执行布局操作，确定每个视图组件在屏幕上的确切位置和边界。这确保了视图组件按照布局的规则正确排列。
4. **绘制（Draw）**：最后，视图系统会执行绘制操作，将每个视图组件的内容绘制到屏幕上，以呈现用户界面。这个操作包括执行视图的 `onDraw()` 方法，允许自定义绘制内容。

总之，一旦 `onCreate()` 方法完成，Android 的视图系统会接管视图的创建、测量、布局和绘制工作，以确保用户界面的正确显示。视图系统会根据布局文件和视图组件的属性来管理整个过程，使应用程序的界面按照设计的规则进行排列和渲染。